# 软约束的轨迹规划

该MATLAB项目演示了如何在硬约束和软约束下进行轨迹规划。这个示例涉及生成从起点到终点的平滑轨迹，同时避开障碍物。

## 目录
- [软约束的轨迹规划](#软约束的轨迹规划)
  - [目录](#目录)
  - [简介](#简介)
  - [要求](#要求)
  - [使用方法](#使用方法)
  - [文件说明](#文件说明)
  - [函数说明](#函数说明)
    - [`costFunction`](#costfunction)
    - [`nonlinearConstraints`](#nonlinearconstraints)
    - [主脚本 (`trajectory_planning.m`)](#主脚本-trajectory_planningm)
  - [自定义](#自定义)
  - [故障排除](#故障排除)

## 简介
轨迹规划是机器人学和自主系统的一个关键方面。本项目提供了一个使用MATLAB优化工具箱进行轨迹规划的示例，该规划既要避开障碍物（硬约束），又要尽可能平滑（软约束）。

## 要求
- MATLAB R2017或更高版本
- 优化工具箱

## 使用方法
1. 克隆或下载此代码库到本地计算机。
2. 打开MATLAB并导航到包含文件的目录。
3. 运行主脚本`trajectory_planning.m`以执行轨迹规划并可视化结果。

## 文件说明
- `trajectory_planning.m`: 设置问题、执行优化并绘制结果的主脚本。
- `README.md`: 这个README文件。

## 函数说明
### `costFunction`
根据以下标准计算给定轨迹的代价：
- **速度平滑度**：通过惩罚连续点之间的位置变化来确保轨迹的平滑性。
- **障碍物惩罚**：惩罚过于接近障碍物的轨迹。

### `nonlinearConstraints`
定义优化问题的硬约束：
- 确保轨迹不与定义的障碍物相交。

### 主脚本 (`trajectory_planning.m`)
主脚本执行以下步骤：
1. **初始化**：设置起点和终点、障碍物位置和半径以及轨迹中的点数。
2. **初始轨迹**：生成从起点到终点的初始直线路径。
3. **优化**：使用`fmincon`函数进行轨迹优化，考虑代价函数和非线性约束。
4. **可视化**：绘制初始轨迹和优化后的轨迹，以及障碍物、起点和终点。

## 自定义
您可以通过修改主脚本中的以下参数来自定义轨迹规划：
- `start_point`和`end_point`：轨迹的起点和终点坐标。
- `obstacle_center`和`obstacle_radius`：障碍物的位置和大小。
- `num_points`：轨迹中的点数，影响路径的分辨率。

您还可以调整`costFunction`中的权重，以不同方式优先考虑平滑性或避障：
```matlab
cost = 10 * velocity_smoothness + 50 * obstacle_penalty;
```

## 故障排除
- **优化不收敛**：确保正确配置`optimset`参数。增加点数（`num_points`）可以提高分辨率，但可能增加计算时间。
- **轨迹与障碍物相交**：验证硬约束在`nonlinearConstraints`函数中是否正确应用。在`costFunction`中调整障碍物惩罚权重，以更严格地避开障碍物。

如果您遇到任何问题或有其他疑问，请随时提出问题或联系项目维护人员。
